<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.activiti.org/test">
  <collaboration id="Collaboration">
    <participant id="reclutamientoProcess" name="GP-02-Requisición de Personal" processRef="reclutamiento"></participant>
  </collaboration>
  <process id="reclutamiento" name="GP - Reclutamiento Personal" isExecutable="true">
    <extensionElements>
      <activiti:executionListener event="start" class="org.alfresco.repo.workflow.activiti.listener.ScriptExecutionListener">
        <activiti:field name="script">
          <activiti:string><![CDATA[var name = person.properties.firstName +' '+person.properties.lastName;
logger.debug('Iniciando ..');
execution.setVariable('rhwf_solicitudUserName', person.properties.userName);]]></activiti:string>
        </activiti:field>
      </activiti:executionListener>
    </extensionElements>
    <laneSet id="laneSet_reclutamiento">
      <lane id="responsableArea" name="Resposable de Area (Solicitante)">
        <flowNodeRef>taskCrearSolicitud</flowNodeRef>
        <flowNodeRef>startevent1</flowNodeRef>
      </lane>
      <lane id="gerenteArea" name="Gerente de Area">
        <flowNodeRef>exclusivegateway1</flowNodeRef>
        <flowNodeRef>endevent6</flowNodeRef>
        <flowNodeRef>taskNotificarSolicitudCancelada</flowNodeRef>
        <flowNodeRef>parallelgateway2</flowNodeRef>
        <flowNodeRef>usertask1</flowNodeRef>
      </lane>
      <lane id="daministrativa" name="Dirección Administrativa">
        <flowNodeRef>parallelgateway1</flowNodeRef>
        <flowNodeRef>taskAutorizarAdm</flowNodeRef>
        <flowNodeRef>parallelgateway2</flowNodeRef>
      </lane>
      <lane id="dcontralodria" name="Dirección de Contraloría">
        <flowNodeRef>taskAutorizarContraloria</flowNodeRef>
      </lane>
      <lane id="dfinanzas" name="Dirección de Finanzas">
        <flowNodeRef>exclusivegateway2</flowNodeRef>
        <flowNodeRef>taskAutorizarFinanzas</flowNodeRef>
        <flowNodeRef>parallelgateway3</flowNodeRef>
        <flowNodeRef>taskNotificarRechazoSol</flowNodeRef>
        <flowNodeRef>endevent7</flowNodeRef>
      </lane>
      <lane id="presidencia" name="Presidencia">
        <flowNodeRef>taskNotificarSolicitudAutorizada</flowNodeRef>
      </lane>
      <lane id="recursoshumanos" name="Recursos Humanos">
        <flowNodeRef>taskIniciarReclutamiento</flowNodeRef>
        <flowNodeRef>endevent5</flowNodeRef>
      </lane>
    </laneSet>
    <exclusiveGateway id="exclusivegateway1" name="¿Autoriza Vacante?"></exclusiveGateway>
    <userTask id="taskAutorizarAdm" name="Autorizar Reclutamiento" activiti:candidateGroups="GROUP_ADMINISTRATIVA" activiti:formKey="rhwf:startSolicitudPersonal"></userTask>
    <parallelGateway id="parallelgateway1" name="Parallel Gateway"></parallelGateway>
    <sequenceFlow id="flowSolicitudAceptada" name="Si" sourceRef="exclusivegateway1" targetRef="parallelgateway1">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${rhwf_outcome == 'Autorizar'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="flow6" sourceRef="parallelgateway1" targetRef="taskAutorizarAdm"></sequenceFlow>
    <sequenceFlow id="flow7" sourceRef="parallelgateway1" targetRef="taskAutorizarFinanzas"></sequenceFlow>
    <userTask id="taskAutorizarFinanzas" name="Autorizar Reclutamiento" activiti:candidateGroups="GROUP_FINANZAS" activiti:formKey="rhwf:startSolicitudPersonal"></userTask>
    <sequenceFlow id="flow8" sourceRef="parallelgateway1" targetRef="taskAutorizarContraloria"></sequenceFlow>
    <userTask id="taskAutorizarContraloria" name="Autorizar Reclutamiento" activiti:candidateGroups="GROUP_CONTRALORIA" activiti:formKey="rhwf:startSolicitudPersonal"></userTask>
    <exclusiveGateway id="exclusivegateway2" name="¿Nueva Posición Autorizada?"></exclusiveGateway>
    <userTask id="taskIniciarReclutamiento" name="Iniciar Reclutamiento Candidatos" activiti:candidateGroups="GROUP_RECURSOS_HUMANOS"></userTask>
    <endEvent id="endevent5" name="End"></endEvent>
    <sequenceFlow id="flow25" sourceRef="taskIniciarReclutamiento" targetRef="endevent5"></sequenceFlow>
    <serviceTask id="taskCrearSolicitud" name="Crear Solicitud" activiti:class="org.alfresco.repo.workflow.activiti.script.AlfrescoScriptDelegate">
      <extensionElements>
        <activiti:field name="script">
          <activiti:string><![CDATA[logger.debug('Creando solicitud ....');]]></activiti:string>
        </activiti:field>
        <activiti:field name="runAs">
          <activiti:string><![CDATA[admin]]></activiti:string>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <serviceTask id="taskNotificarSolicitudCancelada" name="Notificar Solicitud Cancelada" activiti:async="true" activiti:class="org.alfresco.repo.workflow.activiti.script.AlfrescoScriptDelegate">
      <extensionElements>
        <activiti:field name="script">
          <activiti:string><![CDATA[var mail = actions.create("mail");
mail.execute(bpm_package);]]></activiti:string>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="flow28" sourceRef="exclusivegateway1" targetRef="taskNotificarSolicitudCancelada"></sequenceFlow>
    <endEvent id="endevent6" name="End"></endEvent>
    <sequenceFlow id="flow29" sourceRef="taskNotificarSolicitudCancelada" targetRef="endevent6"></sequenceFlow>
    <parallelGateway id="parallelgateway2" name="Parallel Gateway"></parallelGateway>
    <parallelGateway id="parallelgateway3" name="Parallel Gateway"></parallelGateway>
    <sequenceFlow id="flow30" sourceRef="taskAutorizarAdm" targetRef="parallelgateway3"></sequenceFlow>
    <sequenceFlow id="flow31" sourceRef="taskAutorizarContraloria" targetRef="parallelgateway3"></sequenceFlow>
    <sequenceFlow id="flow32" sourceRef="taskAutorizarFinanzas" targetRef="parallelgateway3"></sequenceFlow>
    <sequenceFlow id="flow33" sourceRef="parallelgateway3" targetRef="exclusivegateway2"></sequenceFlow>
    <serviceTask id="taskNotificarRechazoSol" name="Notificar Solicitud Rechazada" activiti:async="true" activiti:class="org.alfresco.repo.workflow.activiti.script.AlfrescoScriptDelegate">
      <extensionElements>
        <activiti:field name="script">
          <activiti:string><![CDATA[var mail = actions.create("mail");
mail.execute(bpm_package);]]></activiti:string>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="flow34" sourceRef="exclusivegateway2" targetRef="taskNotificarRechazoSol"></sequenceFlow>
    <serviceTask id="taskNotificarSolicitudAutorizada" name="Notificar Solicitud Autorizada" activiti:async="true" activiti:class="org.alfresco.repo.workflow.activiti.script.AlfrescoScriptDelegate">
      <extensionElements>
        <activiti:field name="script">
          <activiti:string><![CDATA[var mail = actions.create("mail");
mail.execute(bpm_package);]]></activiti:string>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="flow35" sourceRef="exclusivegateway2" targetRef="taskNotificarSolicitudAutorizada"></sequenceFlow>
    <sequenceFlow id="flow36" sourceRef="taskNotificarSolicitudAutorizada" targetRef="taskIniciarReclutamiento"></sequenceFlow>
    <endEvent id="endevent7" name="End"></endEvent>
    <sequenceFlow id="flow37" sourceRef="taskNotificarRechazoSol" targetRef="endevent7"></sequenceFlow>
    <startEvent id="startevent1" name="Start" activiti:formKey="rhwf:crearSolicitud"></startEvent>
    <sequenceFlow id="flow40" sourceRef="startevent1" targetRef="taskCrearSolicitud"></sequenceFlow>
    <userTask id="usertask1" name="Autorizar Solicitud" activiti:candidateGroups="GROUP_RESPONSABLE_AREA" activiti:formKey="rhwf:autorizarSolicitud"></userTask>
    <sequenceFlow id="flow41" sourceRef="taskCrearSolicitud" targetRef="usertask1"></sequenceFlow>
    <sequenceFlow id="flow42" sourceRef="usertask1" targetRef="exclusivegateway1"></sequenceFlow>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_Collaboration">
    <bpmndi:BPMNPlane bpmnElement="Collaboration" id="BPMNPlane_Collaboration">
      <bpmndi:BPMNShape bpmnElement="reclutamientoProcess" id="BPMNShape_reclutamientoProcess">
        <omgdc:Bounds height="1140.0" width="1110.0" x="80.0" y="220.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="responsableArea" id="BPMNShape_responsableArea">
        <omgdc:Bounds height="162.0" width="1090.0" x="100.0" y="220.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="gerenteArea" id="BPMNShape_gerenteArea">
        <omgdc:Bounds height="162.0" width="1090.0" x="100.0" y="382.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="daministrativa" id="BPMNShape_daministrativa">
        <omgdc:Bounds height="162.0" width="1090.0" x="100.0" y="544.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="dcontralodria" id="BPMNShape_dcontralodria">
        <omgdc:Bounds height="162.0" width="1090.0" x="100.0" y="706.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="dfinanzas" id="BPMNShape_dfinanzas">
        <omgdc:Bounds height="162.0" width="1090.0" x="100.0" y="868.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="presidencia" id="BPMNShape_presidencia">
        <omgdc:Bounds height="162.0" width="1090.0" x="100.0" y="1030.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="recursoshumanos" id="BPMNShape_recursoshumanos">
        <omgdc:Bounds height="162.0" width="1090.0" x="100.0" y="1192.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway1" id="BPMNShape_exclusivegateway1">
        <omgdc:Bounds height="40.0" width="40.0" x="460.0" y="445.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="taskAutorizarAdm" id="BPMNShape_taskAutorizarAdm">
        <omgdc:Bounds height="65.0" width="111.0" x="650.0" y="595.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="parallelgateway1" id="BPMNShape_parallelgateway1">
        <omgdc:Bounds height="40.0" width="40.0" x="460.0" y="607.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="taskAutorizarFinanzas" id="BPMNShape_taskAutorizarFinanzas">
        <omgdc:Bounds height="65.0" width="111.0" x="210.0" y="930.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="taskAutorizarContraloria" id="BPMNShape_taskAutorizarContraloria">
        <omgdc:Bounds height="65.0" width="111.0" x="430.0" y="760.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="exclusivegateway2" id="BPMNShape_exclusivegateway2">
        <omgdc:Bounds height="40.0" width="40.0" x="820.0" y="942.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="taskIniciarReclutamiento" id="BPMNShape_taskIniciarReclutamiento">
        <omgdc:Bounds height="65.0" width="115.0" x="780.0" y="1260.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent5" id="BPMNShape_endevent5">
        <omgdc:Bounds height="35.0" width="35.0" x="1060.0" y="1275.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="taskCrearSolicitud" id="BPMNShape_taskCrearSolicitud">
        <omgdc:Bounds height="71.0" width="121.0" x="260.0" y="255.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="taskNotificarSolicitudCancelada" id="BPMNShape_taskNotificarSolicitudCancelada">
        <omgdc:Bounds height="70.0" width="121.0" x="612.0" y="429.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent6" id="BPMNShape_endevent6">
        <omgdc:Bounds height="35.0" width="35.0" x="826.0" y="446.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="parallelgateway2" id="BPMNShape_parallelgateway2">
        <omgdc:Bounds height="40.0" width="40.0" x="692.0" y="939.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="parallelgateway3" id="BPMNShape_parallelgateway3">
        <omgdc:Bounds height="40.0" width="40.0" x="690.0" y="942.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="taskNotificarRechazoSol" id="BPMNShape_taskNotificarRechazoSol">
        <omgdc:Bounds height="60.0" width="111.0" x="950.0" y="933.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="taskNotificarSolicitudAutorizada" id="BPMNShape_taskNotificarSolicitudAutorizada">
        <omgdc:Bounds height="65.0" width="111.0" x="780.0" y="1100.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="endevent7" id="BPMNShape_endevent7">
        <omgdc:Bounds height="35.0" width="35.0" x="1106.0" y="946.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="startevent1" id="BPMNShape_startevent1">
        <omgdc:Bounds height="35.0" width="35.0" x="160.0" y="273.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="usertask1" id="BPMNShape_usertask1">
        <omgdc:Bounds height="66.0" width="121.0" x="260.0" y="433.0"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="flowSolicitudAceptada" id="BPMNEdge_flowSolicitudAceptada">
        <omgdi:waypoint x="480.0" y="485.0"></omgdi:waypoint>
        <omgdi:waypoint x="480.0" y="607.0"></omgdi:waypoint>
        <bpmndi:BPMNLabel>
          <omgdc:Bounds height="13.0" width="9.0" x="480.0" y="485.0"></omgdc:Bounds>
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow6" id="BPMNEdge_flow6">
        <omgdi:waypoint x="500.0" y="627.0"></omgdi:waypoint>
        <omgdi:waypoint x="650.0" y="627.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow7" id="BPMNEdge_flow7">
        <omgdi:waypoint x="460.0" y="627.0"></omgdi:waypoint>
        <omgdi:waypoint x="272.0" y="628.0"></omgdi:waypoint>
        <omgdi:waypoint x="265.0" y="930.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow8" id="BPMNEdge_flow8">
        <omgdi:waypoint x="480.0" y="647.0"></omgdi:waypoint>
        <omgdi:waypoint x="485.0" y="760.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow25" id="BPMNEdge_flow25">
        <omgdi:waypoint x="895.0" y="1292.0"></omgdi:waypoint>
        <omgdi:waypoint x="1060.0" y="1292.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow28" id="BPMNEdge_flow28">
        <omgdi:waypoint x="500.0" y="465.0"></omgdi:waypoint>
        <omgdi:waypoint x="594.0" y="465.0"></omgdi:waypoint>
        <omgdi:waypoint x="612.0" y="464.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow29" id="BPMNEdge_flow29">
        <omgdi:waypoint x="733.0" y="464.0"></omgdi:waypoint>
        <omgdi:waypoint x="826.0" y="463.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow30" id="BPMNEdge_flow30">
        <omgdi:waypoint x="705.0" y="660.0"></omgdi:waypoint>
        <omgdi:waypoint x="710.0" y="942.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow31" id="BPMNEdge_flow31">
        <omgdi:waypoint x="485.0" y="825.0"></omgdi:waypoint>
        <omgdi:waypoint x="475.0" y="1026.0"></omgdi:waypoint>
        <omgdi:waypoint x="593.0" y="1026.0"></omgdi:waypoint>
        <omgdi:waypoint x="711.0" y="1026.0"></omgdi:waypoint>
        <omgdi:waypoint x="710.0" y="982.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow32" id="BPMNEdge_flow32">
        <omgdi:waypoint x="321.0" y="962.0"></omgdi:waypoint>
        <omgdi:waypoint x="690.0" y="962.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow33" id="BPMNEdge_flow33">
        <omgdi:waypoint x="730.0" y="962.0"></omgdi:waypoint>
        <omgdi:waypoint x="820.0" y="962.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow34" id="BPMNEdge_flow34">
        <omgdi:waypoint x="860.0" y="962.0"></omgdi:waypoint>
        <omgdi:waypoint x="950.0" y="963.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow35" id="BPMNEdge_flow35">
        <omgdi:waypoint x="840.0" y="982.0"></omgdi:waypoint>
        <omgdi:waypoint x="835.0" y="1100.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow36" id="BPMNEdge_flow36">
        <omgdi:waypoint x="835.0" y="1165.0"></omgdi:waypoint>
        <omgdi:waypoint x="837.0" y="1260.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow37" id="BPMNEdge_flow37">
        <omgdi:waypoint x="1061.0" y="963.0"></omgdi:waypoint>
        <omgdi:waypoint x="1106.0" y="963.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow40" id="BPMNEdge_flow40">
        <omgdi:waypoint x="195.0" y="290.0"></omgdi:waypoint>
        <omgdi:waypoint x="260.0" y="290.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow41" id="BPMNEdge_flow41">
        <omgdi:waypoint x="320.0" y="326.0"></omgdi:waypoint>
        <omgdi:waypoint x="320.0" y="433.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="flow42" id="BPMNEdge_flow42">
        <omgdi:waypoint x="381.0" y="466.0"></omgdi:waypoint>
        <omgdi:waypoint x="460.0" y="465.0"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>